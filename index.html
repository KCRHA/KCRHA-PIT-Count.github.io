<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Point-in-Time Count | Volunteer Portal</title>
    <link rel="icon" type="image/x-icon" href="KCRHA-logo-brandmark-full-color.png">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* CSS STYLING */
        :root {
            --primary-blue: #172B69;
            --accent-teal: #1B8477;
            --light-gray: #f4f7f9;
            --text-dark: #333333;
            --text-white: #FFFFFF;
        }
        
        .header-logo {
            max-width: 30%; /* Adjust size as needed */
            height: auto;
            margin-bottom: 1rem;
        }

        body {
            font-family: 'Arial Nova', Arial, sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text-dark);
            line-height: 1.6;
        }

        header {
            background-color: var(--light-gray);
            color: var(--text-dark);
            padding: 2rem 1rem;
            text-align: center;
        }

        /* Navigation Tabs */
        nav {
            background-color: var(--accent-teal);
            display: flex;
            justify-content: left;
            overflow: auto;
            border-bottom: 2px solid var(--light-gray);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav button {
            background: none;
            border: none;
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: bold;
            color: var(--text-white);
            cursor: pointer;
            transition: 0.3s;
        }
        
        nav button:hover {
            color: var(--accent-teal);
            background-color: var(--text-white);
        }
        
        nav button.active {
            border-bottom: 4px solid var(--text-dark);
            background-color: var(--accent-teal);
            color: var(--text-white);
        }
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        /* Apply these to all links and buttons in the nav */
        .tab-link {
            display: inline-block; /* Crucial for links to accept padding/height */
            text-decoration: none; /* Removes the underline from the <a> tag */
            appearance: none;      /* Removes default browser button styling */
            cursor: pointer;
            
            /* Ensure these match your existing button styles */
            padding: 1rem 2rem;
            border: none; 
            background-color: none;
            color: var(--text-white);
            font-family: inherit;
            font-weight: bold;
            font-size: 1rem;
            vertical-align: middle; /* Keeps text aligned with adjacent buttons */
            line-height: normal;    /* Prevents height mismatch */
        }
        
        /* Match the hover state of your existing buttons */
        .tab-link:hover {
            color: var(--accent-teal);
            background-color: var(--text-white);
        }

        /* Professional Buttons */
        .cta-button {
            display: inline-block;
            background-color: var(--accent-teal);
            color: white;
            padding: 0.8rem 1.5rem;
            text-decoration: none;
            border-radius: 4px;
            font-weight: bold;
            margin-top: 1rem;
        }

        /* Resource Styling */
        .resource-card {
            background: var(--light-gray);
            border-left: 5px solid var(--primary-blue);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 0 4px 4px 0;
        }

        .resource-card h3 {
            margin-top: 0;
            color: var(--primary-blue);
        }

        footer {
            text-align: center;
            padding: 2rem;
            font-size: 0.9rem;
            color: #666;
            background: var(--light-gray);
            margin-top: 4rem;
        }
        /* This makes the map look great on mobile and desktop */
        .map-container {
            position: relative;
            padding-bottom: 125%; /* Square aspect ratio */
            height: 100%;
            overflow: auto;
        }
        /* Control the style of the map widget */
        .map-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 97%;
            height: 97%;
            border: 1px solid #ccc;
            border-radius: 8px;
        }
        /* Control the style of the calendar widget */
        .calendar-container {
            position: relative;
            overflow: auto;
            width: 100%;
            height: 600px; 
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #fff; /* Prevents seeing the page background through the load */
        }
        
        .calendar-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%; 
            height: 100%;
            border: none; 
        }
        
        /* Styling for Markdown-injected content */
        #markdown-container {
            line-height: 1.8;
            color: var(--text-dark);
        }
        
        #markdown-container h1, 
        #markdown-container h2 {
            color: var(--primary-blue);
            border-bottom: 2px solid var(--light-gray);
            padding-bottom: 0.3rem;
            margin-top: 1.5rem;
        }
        
        #markdown-container h3 {
            color: var(--accent-teal);
        }
        
        #markdown-container ul, 
        #markdown-container ol {
            padding-left: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        #markdown-container li {
            margin-bottom: 0.5rem;
        }
        
        /* Style for links inside markdown */
        #markdown-container a {
            color: var(--accent-teal);
            text-decoration: none;
            font-weight: bold;
        }
        
        #markdown-container a:hover {
            text-decoration: underline;
        }
        
        /* Style for code blocks or technical instructions */
        #markdown-container code {
            background-color: var(--light-gray);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
        }
        
        #markdown-container blockquote {
            border-left: 4px solid var(--accent-teal);
            margin: 1.5rem 0;
            padding: 0.5rem 1rem;
            background: #f9fdfc;
            font-style: italic;
        }

        /* Style for Subregion dropdown selector */
        .schedule-selector {
            max-width: 250px;
            margin: 20px auto;
            padding: 30px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
        }
    
        .styled-select {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid var(--primary-blue); /* KCRHA primary blue */
            border-radius: 4px;
            background-color: white;
            cursor: pointer;
            margin-top: 10px;
        }
    
        .styled-select:hover {
            background-color: #f9f9f9;
        }
    
        .helper-text {
            font-size: 0.85rem;
            color: #666;
            margin-top: 15px;
            font-style: italic;
        }
    
        optgroup {
            font-weight: bold;
            color: #002b5c;
            background: #f0f0f0;
        }

        /* Format the button that redirects to Doodle sign-up */
        .button-center-wrapper {
            display: flex;
            justify-content: center; /* Horizontal centering */
            align-items: center;     /* Vertical alignment */
            padding: 20px 0;         /* Adds breathing room above and below */
            width: 100%;
        }
        
        /* Optional: Ensure the button doesn't get too wide on mobile */
        #booking-button {
            max-width: 90%;
            text-align: center;
        }

        /* Set the format for the Subregional Coordinator contact information */
        .coordinator-box {
            text-align: center; /* Centers all text inside the box */
            background-color: #fcfcfc;
            border: 1px solid #eee;
            padding: 15px;
            border-radius: 4px;
            margin-top: 15px;
        }
        
        .coordinator-box p {
            margin: 10px 0; /* Adds vertical spacing between the Name and Contact sections */
        }
        
        .coordinator-box strong {
            color: var(--primary-blue);
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.05rem;
        }
        
        #coord-name, #coord-phone {
            font-size: 1.1rem;
            display: inline-block;
            margin-top: 5px;
        }
    </style>
</head>
<body>

<header>
    <img src="KCRHA-logo-lockup-full-color.png" alt="KCRHA Logo" class="header-logo">
    <h1>2026 Point-in-Time Count</h1>
    <p>A vital part of our community effort to end homelessness in <a href="https://kcrha.org/community-data/king-county-point-in-time-count/" style="color: var(--primary-blue); font-weight: bold;" target="_blank">King County</a></p>
</header>

<nav id="main-nav">
    <button class="tab-link active" onclick="openTab(event, 'home')">Home</button>
    <button class="tab-link" onclick="openTab(event, 'resources')">Resources</button>
    <button class="tab-link" onclick="openTab(event, 'maps')">Hub Sites Map</button>
    <button class="tab-link" onclick="openTab(event, 'schedule')">Site Schedules</button>
    <a href="ice_response.html" target="_blank" class="tab-link ice-link">ICE Response Protocol</a>
</nav>

<div class="container">
    
    <div id="home" class="tab-content active">
        <h2>About the PIT Count</h2>
        <p>The <a href="https://kcrha.org/community-data/king-county-point-in-time-count/" style="color: var(--primary-blue); font-weight: bold;" target="_blank">Point-in-Time (PIT)</a> count is a count of sheltered and unsheltered people experiencing homelessness that takes place in late January.
            <br>
            <br>
            In King County, we employ the <i>Respondent-Driven</i> sampling model (<i>RDS</i>) to collect our data. We use long-form surveys to collect thorough and accurate information about each of the experiences of our neighbors who are experiencing unsheltered homelessness.
            <br>
            <br>
            Your participation is essential to our ability to gain the insights and secure the funding needed to bring our neighbors indoors and bring our <i>Homelessness Response System</i> (<i>HRS</i>) to functional ZERO.</p>
        <!-- -->
        <!-- Link to section within the page without modifying the URL -->
        <a href="javascript:void(0)" 
           onclick="document.getElementById('notifications-section').scrollIntoView({behavior: 'smooth'})" 
           class="cta-button">
           <i>Check Notifications</i>
        </a>
        <br>
        <br>
        <!-- -->
        <div style="background-color: #eef2ff; padding: 1.5rem; border-radius: 8px; border: 1px solid #d1d9e6;">
            <h2 style="color: var(--primary-blue); margin-top: 0;"><u><b>Event Details</b></u></h2>
            <p><strong>2026 Unsheltered PIT Count data collection is scheduled for:<br></strong> Monday – Friday, January 26 through February 6, 2026 (weather permitting).</p>
            <p><strong>Location:</strong><br><a href="https://kcrha.github.io/KCRHA-PIT-Count.github.io/#maps" target="_blank">Regional HUB Sites</a></p>
            <a href="https://rds-test-bwdfb4akakaugcc9.westus2-01.azurewebsites.net/login" class="cta-button" target="_blank">PIT 2026 Survey Tool (Login)</a>
            <br>
            <a href="https://app.jeenie.com/v3/login?utm_source=google&utm_medium=cpc&utm_term=jeenie%20interpreter" class="cta-button" target="_blank">Jeenie Translation Services (Login)</a>
        </div>
        <br>
        <section id="notifications-section" style="background-color: #eef2ff; padding: 1.5rem; border-radius: 8px; border: 1px solid #d1d9e6;">
            <h2 style="color: var(--primary-blue); margin-top: 0;"><u><b>Updates and Notifications</b></u></h2>
            <div id="markdown-container" class="resource-card">
                Loading content...
            </div>
        </section>
    </div>

    <div id="resources" class="tab-content">
        <h2>Volunteer and Site Management Resources</h2>
        <p>Access training materials, operation manuals, reports and documents.</p>
        <div class="resource-card">
            <h3>Survey Resources</h3>
            <p>Instructions for using the mobile surveying app and paper forms for backup.</p>
            <a href="#" style="color: var(--accent-teal); font-weight: bold;">Survey App User Guide →</a>
            <br>
            <a href="#" style="color: var(--accent-teal); font-weight: bold;">Download and Print Paper Survey →</a>
        </div>

        <div class="resource-card">
            <h3>Volunteer Training and Materials</h3>
            <p>View the volunteer handbook and access volunteer training slides.</p>
            <a href="2026 Volunteer Training Manual_Final.pdf"
                style="color: var(--accent-teal); font-weight: bold;" target="_blank">Volunteer Handbook →</a>
            <br>
            <a href="2026 Unsheltered PIT CountHUB Leads and Surveyor Volunteer Training_final.pdf"
                style="color: var(--accent-teal); font-weight: bold;" target="_blank">Training Slides →</a> 
        </div>

        <div class="resource-card">
            <h3>For Site Leads</h3>
            <p>Essential resources for safe site management.</p>
            <a href="https://app.smartsheet.com/b/form/8e21239010584be4ac2d08b993c854ef"
                target="_blank" style="color: var(--accent-teal); font-weight: bold;">Incident Report Form →</a>
            <br>
            <a href="https://app.smartsheet.com/b/form/02f84ceb60eb4b7296dbcbcc9326e3b8"
                target="_blank" style="color: var(--accent-teal); font-weight: bold;">Daily Hub Close-out Form →</a>
            <br>
            <a href="#" style="color: var(--accent-teal); font-weight: bold;">Hub Site Operations Manual →</a>
        </div>
    </div>

    <!-- Add Google map of Hub Sites for ease of navigation -->
    <div id="maps" class="tab-content">
        <h2>Hub Sites Map</h2>
        <p>Use the interactive map below to locate regional resources and deployment hubs.</p>
        <div class="map-container">
            <iframe src="https://www.google.com/maps/d/u/0/embed?mid=1pR8ll32bitMux9RBMqWjToCY1oDPiug&ehbc=2E312F&noprof=1" width="640" height="480"></iframe>
        </div>
    </div>

    <!-- Add Google calendar for site schedule mgmt -->
    <div id="schedule" class="tab-content">
        <h2>Volunteer/ Site Schedules</h2>
        
        <!-- Create the Subregion selector -->
        <div class="schedule-selector">
            <h3>Select a Subregion</h3>
            <p>Select a region below to view available shifts and site schedules:</p>
            
            <!-- Add Doodle sign-up links and labels here -->
            <select id="region-menu" class="styled-select">
                <option value="" disabled selected>— Choose a Region —</option>
                <!-- Downtown Seattle -->
                <option
                    value="https://doodle.com/sign-up-sheet/participate/2a2602ef-ac6f-489f-9465-89b32f2edcc4/select"
                    data-name="Cathea Carey"
                    data-phone="206-809-5711"
                    data-cal="ad9e3bd7a8fd9a89eac8557efccb4ba73c6f5959e9618cb3d21c4132c3fcea9f@group.calendar.google.com">
                    Downtown Seattle
                </option>
                <!-- East King County -->
                <option
                    value="https://doodle.com/sign-up-sheet/participate/7ac8ad46-3f5c-4c32-9b78-a902ad58e0ea/select"
                    data-name="Claire Guilmette"
                    data-phone="206-735-6448"
                    data-cal="38197aabd4154738887f1ebb33245a48c4b113b336db0ab5f18b7410227bacc3@group.calendar.google.com">
                    East King County
                </option>
                <!-- North King County -->
                <option
                    value="https://doodle.com/sign-up-sheet/participate/9535c4a5-ddad-477c-94f9-3db163170ee0/select"
                    data-name="Joel Bernstein"
                    data-phone="206-771-2097"
                    data-cal="a3f1e80ae158552e9e17bd597d4ef472304659b41f880baedf07ef0dd008f696@group.calendar.google.com">
                    North King County
                </option>
                <!-- North Seattle -->
                <option
                    value="https://doodle.com/sign-up-sheet/participate/1d82d1cd-0f8c-4060-9135-5eacee693954/select"
                    data-name="Ewan Andreasen"
                    data-phone="206-681-5536"
                    data-cal="5e0cc6a1394f76c6b1b6264607f0b257adf1260ae1afdab68d5727c8fdf34eb1@group.calendar.google.com">
                    North Seattle
                </option>
                <!-- Snoqualmie Valley -->
                <option
                    value="https://doodle.com/sign-up-sheet/participate/3a572db7-ea00-46e4-a89b-9ee663e2071a/select"
                    data-name="Daniel Ramos III"
                    data-phone="206-513-3532"
                    data-cal="834c70b2eddd9e1dd0866d1a80f339ef6b7b240cc93ee4f88c814adc37fcff42@group.calendar.google.com">
                    Snoqualmie Valley
                </option>
                <!-- South East King County -->
                <option
                    value="https://doodle.com/sign-up-sheet/participate/1145928d-2903-4bd3-994d-9af1d536dfe8/select"
                    data-name="Ben Mathewson"
                    data-phone="206-945-6775"
                    data-cal="563441a03834913b9d6aba72610031b7eded158face24cc119bf224faa0f4b01@group.calendar.google.com">
                    South East King County
                </option>
                <!-- South King County -->
                <option
                    value="https://doodle.com/sign-up-sheet/participate/91369666-53b7-4d1e-8d15-b34cae226bad/select"
                    data-name="Janelle Rothfolk"
                    data-phone="425-457-2349"
                    data-cal="3918b19390785b1fcdfc070e9996120fbd4e8ee73b994191b9a37c20b1e611db@group.calendar.google.com">
                    South King County
                </option>
                <!-- South Seattle -->
                <option
                    value="https://doodle.com/sign-up-sheet/participate/0af51cc2-cf05-43fb-98a0-e5ba521d4852/select"
                    data-name="Cathea Carey"
                    data-phone="206-809-5711"
                    data-cal="c37dae6389a666262c935d13bd4e0ae2adfa11b495b230b51884b2597210a948@group.calendar.google.com">
                    South Seattle
                </option>
                <!-- Vashon Island -->
                <!-- <option
                    value=""
                    coord-name="Cathea Carey"
                    coord-phone="206-809-5711"
                    data-cal="">
                    Vashon Island
                </option> -->
            </select>
            <div id="coordinator-info" class="coordinator-box" style="display: none;">
                <hr>
                <p>
                    <strong>Subregional Coordinator:</strong><br>
                    <span id="coord-name"></span>
                </p>
                <p>
                    <strong>Contact:</strong><br>
                    <span id="coord-phone"></span>
                </p>
            </div>
        </div>

        <!-- Add a button to navigate to the Doodle sign-up -->
        <div class="button-center-wrapper">
            <a id="booking-button" href="https://doodle.com/home" target="_blank" class="cta-button">
                Manage Site Sign-up on Doodle
            </a>
        </div>
        
        <!-- Display the calendar that corresponds to the selected subregion -->
        <div id="calendar" style="margin-top: 20px; display: none;">
            <h4>Live Schedule View</h4>
            <div class="calendar-container">
                <iframe id="calendar-iframe" src="" style="border: 0" width="100%" height="600" frameborder="0" scrolling="no"></iframe>
            </div>
        </div>
    </div>
</div>

<footer>
    &copy; King County Regional Homelessness Authority (KCRHA) | 2026 Point-in-Time Count
</footer>

<script>
    // This script changes the Subregional Coordinator info on subregion selection
    document.getElementById('region-menu').addEventListener('change', function() {
        const selectedOption = this.options[this.selectedIndex];
        
        // 1. Extract all data
        const doodleUrl = selectedOption.value;
        const calendarId = selectedOption.getAttribute('data-cal');
        const regionName = selectedOption.text;
        const coordName = selectedOption.getAttribute('data-name');
        const coordPhone = selectedOption.getAttribute('data-phone');

        // 2. Update Coordinator Info (Centered with Line Breaks)
        const coordBox = document.getElementById('coordinator-info');
        
        if (coordName && coordPhone) {
            document.getElementById('coord-name').textContent = coordName;
            document.getElementById('coord-phone').textContent = coordPhone;
            
            // Display the box (CSS handles the centering)
            coordBox.style.display = 'block';
        } else {
            coordBox.style.display = 'none';
        }
    
        // 3. Update Calendar and Button
        if (calendarId) {
            const container = document.getElementById('calendar');
            const iframe = document.getElementById('calendar-iframe');
            const bookingBtn = document.getElementById('booking-button');
            
            container.style.display = 'block';
            bookingBtn.href = doodleUrl || "#";
            bookingBtn.innerText = `Manage Site Sign-up for ${regionName} on Doodle`;
            
            // Use a template literal for the URL to make it readable
            const embedUrl = `https://calendar.google.com/calendar/embed?src=${encodeURIComponent(calendarId)}&ctz=America%2FLos_Angeles&mode=WEEK&dates=20260125/20260207&showTitle=0&showPrint=0&showTabs=0`;
            
            iframe.src = embedUrl;
            container.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    });
    // Add script to convert markdown (updates and notifications) to HTML on the fly
    async function loadMarkdown() {
        const container = document.getElementById('markdown-container');
        try {
            // This adds a timestamp to the URL, making the browser think it's a brand new file
            const response = await fetch('notifications.md?t=' + new Date().getTime());
            if (!response.ok) throw new Error('Failed to load notifications');

            const text = await response.text();

            // Create a timestamp string
            const now = new Date().toLocaleString(); 
            const stamp = `<p style="font-size: 1.0rem; color: #333333;">Last refreshed: ${now}</p>`;
        
            // Inject the stamp + the converted Markdown
            container.innerHTML = stamp + marked.parse(text);
        } catch (error) {
            container.innerHTML = "<p>Error loading documentation.</p>";
            console.error(error);
        }
    };
    // function to handle tab behavior for UI
    function openTab(evt, tabName) {
        var i, tabcontent, tablinks;

        // 1. Hide all tab content
        tabcontent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
            tabcontent[i].classList.remove("active");
        }

        // 2. Deactivate all tab buttons
        tablinks = document.getElementsByClassName("tab-link");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].classList.remove("active");
        }

        // 3. Show the current tab and add an "active" class
        const selectedTab = document.getElementById(tabName);
        if (selectedTab) {
            selectedTab.style.display = "block";
            selectedTab.classList.add("active");
        }

        // 4. Highlight the button
        if (evt) {
            evt.currentTarget.classList.add("active");
        } else {
            // If triggered by URL (no event), find the button by text or index
            Array.from(tablinks).forEach(btn => {
                if (btn.getAttribute('onclick').includes(tabName)) {
                    btn.classList.add("active");
                }
            });
        }

        // Set special behavior for the notifications and updates tab
        if (tabName === 'home') {
            loadMarkdown();
        }

        // 5. UPDATE THE URL
        window.location.hash = tabName;
    }

    // Handle Direct Links (e.g., someone visits yoursite.com/#resources)
    window.addEventListener('DOMContentLoaded', () => {
        const currentHash = window.location.hash.replace('#', '');
        if (currentHash) {
            openTab(null, currentHash);
        }
    });

    // Handle Back/Forward buttons in the browser
    window.addEventListener('hashchange', () => {
        const currentHash = window.location.hash.replace('#', '');
        if (currentHash) {
            openTab(null, currentHash);
        }
    });

    // Trigger the load when the page starts
    window.addEventListener('DOMContentLoaded', loadMarkdown);
</script>

</body>
</html>
